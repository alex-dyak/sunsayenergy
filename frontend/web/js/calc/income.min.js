const getArrayF=()=>{let t=null;return $.ajax({type:"get",url:"/site/calculator",data:{type:"F"},dataType:"json",async:!1,success:function(e){t=e}}),t},getArrayY=()=>{let t=null;return $.ajax({type:"get",url:"/site/calculator",data:{type:"Y"},dataType:"json",async:!1,success:function(e){t=e}}),t},getJ=()=>{let t=null;return $.ajax({type:"get",url:"/site/calculator",data:{type:"J"},dataType:"json",async:!1,success:function(e){t=e}}),t},getG=()=>{let t=null;return $.ajax({type:"get",url:"/site/calculator",data:{type:"G"},dataType:"json",async:!1,success:function(e){t=e}}),t},years=()=>{let t=[(new Date).getFullYear()+rik];for(let e=1;e<20;e++)t.push((new Date).getFullYear()+e+rik);return t},pushToTemplate=(t,e)=>{$(".result-value").text("$"+t.toFixed(0).replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1 ")),$(".income-value").text("$"+e.toFixed(0).replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1 "))};var F=null,Y=null,J=null,G=null,USD=null,EUR=null,chart=null,canvas=$("#income-graphic"),chartOption={layout:{padding:{left:0,right:0,top:0}},legend:{display:!1},responsive:!1,hover:{mode:"nearest",intersect:!0},scales:{yAxes:[{display:!1}],xAxes:[{display:!1}]}},chartPlugins=[{afterDatasetsDraw:function(t){if(chart_type=t.config.type,t.tooltip._active&&t.tooltip._active.length&&"line"===chart_type){let e=t.tooltip._active[0],a=t.chart.ctx,r=t.scales["y-axis-0"],n=e.tooltipPosition().x,s=e.tooltipPosition().y;topY=r.top,bottomY=r.bottom,a.save(),a.beginPath(),a.moveTo(n,s),a.lineTo(n,bottomY),a.lineWidth=3,a.strokeStyle="#B7D3F7",a.stroke(),a.restore()}}}],chartDataSetStyle=[{backgroundColor:["#B7D3F7"],borderColor:["transparent"],borderWidth:0,pointRadius:0,fill:!0},{backgroundColor:["#ffd100"],borderColor:["transparent"],borderWidth:0,pointRadius:0,fill:!0}];const getActualCourse=t=>{var e=null;return $.ajax({method:"get",url:"https://bank.gov.ua/NBUStatService/v1/statdirectory/exchange?valcode="+t+"&date="+(new Date).toISOString().slice(0,10).replace(/-/g,"")+"&json",dataType:"json",async:!1,success:function(t){e=t[0].rate.toFixed(3)},error:function(){e="USD"==t?26:28}}),e},getY=t=>{var e=null;switch(t){case 5:e=Y.y1;break;case 7.5:e=Y.y2;break;case 10:e=Y.y3;break;case 12.5:e=Y.y4;break;case 15:e=Y.y5;break;case 17.5:e=Y.y6;break;case 20:e=Y.y7;break;case 22.5:e=Y.y8;break;case 25:e=Y.y9;break;case 27.5:e=Y.y10;break;case 30:e=Y.y11;break;case 32.5:e=Y.y12;break;case 35:e=Y.y13}return e},getF=t=>{let e=null;switch(t){case 5:e=F.f1;break;case 7.5:e=F.f2;break;case 10:e=F.f3;break;case 12.5:e=F.f4;break;case 15:e=F.f5;break;case 17.5:e=F.f6;break;case 20:e=F.f7;break;case 22.5:e=F.f8;break;case 25:e=F.f9;break;case 27.5:e=F.f10;break;case 30:e=F.f11;break;case 32.5:e=F.f12;break;case 35:e=F.f13}return e},getPrice=(t,e)=>{let a=0;return parseInt(a=t*e)},getIncome=(t,e,a,r)=>{let n=null,s=0,i=0;return 12*a<r?(s=12*a*J/t,i=G*e*(r-12*a)/t):(s=r*J/t,i=0),parseInt((s+i).toFixed(0))},getPayback=(t,e)=>{let a=0;return parseInt((t/e).toFixed(0))},createGraphic=(t,e,a)=>{parseInt(e);let r=parseFloat(a),n=USD,s=EUR,i=(getF(r),getY(r)),o=getPrice(r,i),l=getIncome(n,s,J,G),c=getPayback(o,l),u=2,d=[(new Date).getFullYear()+rik],h=[0],p=[0],x=[0];for(let t=1;t<20;t++)d.push((new Date).getFullYear()+t+rik),p.push(parseInt(l*t)),h.push(parseInt((t*u+parseInt(r)/1600).toFixed(0))),u++;for(let t=1;t<=c;t++)x.push(h[t]),h[t-1]=null;chart=new Chart(t,{type:"line",data:{labels:d,datasets:chartDataSetStyle},options:chartOption,plugins:chartPlugins})};Chart.elements.Line.prototype.draw=function(){this._chart.ctx.save(),this._chart.ctx.strokeStyle="#B7D3F7";let t=this._chart.getDatasetMeta(0).data,e=t[t.length-1]._model.x,a=t[t.length-1]._model.y,r=this._chart.scales["y-axis-0"].bottom,n=okupn+t.length+rokiv;this._chart.ctx.beginPath(),this._chart.ctx.lineWidth=3,this._chart.ctx.moveTo(e,a),this._chart.ctx.lineTo(e,r),this._chart.ctx.fillStyle="#393939",$(window).width()<420?(this._chart.ctx.font='500 12px "Montserrat", sans-serif',this._chart.ctx.textBaseline="bottom",t.length>11?(this._chart.ctx.textAlign="right",this._chart.ctx.fillText(n,e-2,r)):(this._chart.ctx.textAlign="left",this._chart.ctx.fillText(n,e+2,r))):(this._chart.ctx.font='500 16px "Montserrat", sans-serif',this._chart.ctx.textBaseline="bottom",t.length>14?(this._chart.ctx.textAlign="right",this._chart.ctx.fillText(n,e-5,r)):(this._chart.ctx.textAlign="left",this._chart.ctx.fillText(n,e+5,r))),this._chart.ctx.stroke(),this._chart.ctx.restore()};const updateChart=(t,e,a,r)=>{t.options.tooltips={displayColors:!1,mode:"nearest",axis:"x",intersect:!1,backgroundColor:"transparent",titleFontFamily:'"Montserrat", sans-serif',titleFontSize:16,titleFontColor:"#393939",bodyFontFamily:'"Montserrat", sans-serif',bodyFontSize:16,bodyFontColor:"#393939",yAlign:"bottom",yPadding:0,callbacks:{label:function(t,e){return 0==t.index?e=r[0]:1==t.index?e=r[1]:2==t.index?e=r[2]:3==t.index?e=r[3]:4==t.index?e=r[4]:5==t.index?e=r[5]:6==t.index?e=r[6]:7==t.index?e=r[7]:8==t.index?e=r[8]:9==t.index?e=r[9]:10==t.index?e=r[10]:11==t.index?e=r[11]:12==t.index?e=r[12]:13==t.index?e=r[13]:14==t.index?e=r[14]:15==t.index?e=r[15]:16==t.index?e=r[16]:17==t.index?e=r[17]:18==t.index?e=r[18]:19==t.index?e=r[19]:20==t.index&&(e=r[20]),"$"+e}}},t.data.datasets[0].data=e,t.data.datasets[1].data=a,t.update()},calculatuion=(t,e)=>{let a=parseInt(t),r=parseFloat(e),n=USD,s=EUR,i=getF(r),o=getY(r),l=getPrice(r,o),c=getIncome(n,s,a,i),u=getPayback(l,c),d=2,h=[(new Date).getFullYear()],p=[0],x=[0],g=[0];for(let t=1;t<20;t++)h.push((new Date).getFullYear()+t),x.push(parseInt(c*t)),p.push(parseInt((t*d+parseInt(r)/1600).toFixed(0))),d++;for(let t=1;t<=u;t++)g.push(p[t]);pushToTemplate(l,c),updateChart(chart,g,p,x)};$("input#income-house, input#income-power").ionRangeSlider({skin:"round",onChange:function(t){$(window).width()<1024&&$("body").css("overflow-y","hidden");let e=$("input#income-house").val(),a=$("input#income-power").val();calculatuion(e,a)},onFinish:function(t){$(window).width()<1024&&$("body").css("overflow-y","scroll")}}),$(window).on("load",function(){F=getArrayF(),Y=getArrayY(),J=getJ(),G=getG(),USD=getActualCourse("USD"),EUR=getActualCourse("EUR");let t=parseInt($("input#income-house").val()),e=parseFloat($("input#income-power").val());createGraphic(canvas,t,e),calculatuion(t,e)});