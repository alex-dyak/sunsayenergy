const getArrayM=()=>{let t=null;return $.ajax({type:"get",url:"/site/calculator",data:{type:"M1"},dataType:"json",async:!1,success:function(e){t=e}}),t},getL=()=>{let t=null;return $.ajax({type:"get",url:"/site/calculator",data:{type:"L"},dataType:"json",async:!1,success:function(e){t=e}}),t},getCoefAKB=()=>{let t=null;return $.ajax({type:"get",url:"/site/calculator",data:{type:"coefAKB"},dataType:"json",async:!1,success:function(e){t=e}}),t},getCoefSun=()=>{let t=null;return $.ajax({type:"get",url:"/site/calculator",data:{type:"coefSun"},dataType:"json",async:!1,success:function(e){t=e}}),t},getCoefNight=()=>{let t=null;return $.ajax({type:"get",url:"/site/calculator",data:{type:"coefNight"},dataType:"json",async:!1,success:function(e){t=e}}),t},getActualCourse=t=>{let e=null;return $.ajax({method:"get",url:"https://bank.gov.ua/NBUStatService/v1/statdirectory/exchange?valcode="+t+"&date="+(new Date).toISOString().slice(0,10).replace(/-/g,"")+"&json",dataType:"json",async:!1,success:function(t){e=t[0].rate.toFixed(3)},error:function(){e="USD"==t?26:28}}),e},pushToTemplate=(t,e)=>{$(".result-value").text("$"+t.toFixed(0).replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1 ")),$(".power-value").text(e)};var M=null,L=null,coefAKB=null,coefNight=null,coefSun=null,USD=null,EUR=null,chart=null,canvas=$("#comfort-graphic"),chartOption={layout:{padding:{left:0,right:0,top:10}},legend:{display:!1},responsive:!0,hover:{mode:"nearest",intersect:!0},scales:{yAxes:[{display:!1}],xAxes:[{display:!1}]}},chartPlugins=[{afterDatasetsDraw:function(t){if(chart_type=t.config.type,t.tooltip._active&&t.tooltip._active.length&&"line"===chart_type){var e=t.tooltip._active[0],a=t.chart.ctx,o=t.scales["y-axis-0"],n=e.tooltipPosition().x,r=e.tooltipPosition().y;topY=o.top,bottomY=o.bottom,a.save(),a.beginPath(),a.moveTo(n,r),a.lineTo(n,bottomY),a.lineWidth=3,a.strokeStyle="#B7D3F7",a.stroke(),a.restore()}}}];const getM=t=>{let e=null;return t>0&&t<6?e=M.m1:t>6&&t<12?e=M.m2:t>12&&t<18?e=M.m3:t>18&&t<24?e=M.m4:t>24&&t<100&&(e=M.m5),e},getPrice=(t,e,a)=>{let o=0,n=0;return parseFloat((n=t+(o=e/30*.3*1.3*a*L)).toFixed(1))},getPriceReserve=(t,e)=>{let a=0;return parseFloat(a=t*e)},getPower=t=>{let e=0;return parseFloat((e=t/30/3.1).toFixed(1))},declOfNum=(t,e)=>(cases=[2,0,1,1,1,2],e[t%100>4&&t%100<20?2:cases[t%10<5?t%10:5]]),createChart=(t,e,a)=>{let o=["1 день"],n=parseInt(e),r=parseInt(a),i=getPower(n),s=getM(i),c=getPriceReserve(i,s),l=getPrice(c,n,r),h=1.2,u=[],d=[];for(let t=1;t<=10;t++)l=getPrice(c,n,t),u.push(l.toFixed(0)*h),d.push(parseInt(l.toFixed(0))),h++;for(let t=1;t<10;t++)o.push(t+1+" "+declOfNum(t+1,[den,dni,dniv]));chart=new Chart(t,{type:"line",data:{labels:o,datasets:[{data:u,backgroundColor:["#ffd100"],borderColor:["transparent"],borderWidth:0,pointRadius:0,fill:!0,showLines:!0}]},options:chartOption,plugins:chartPlugins})},updateChart=(t,e)=>{t.options.tooltips={displayColors:!1,mode:"nearest",axis:"x",intersect:!1,backgroundColor:"transparent",titleFontFamily:'"Montserrat", sans-serif',titleFontSize:16,titleFontColor:"#393939",bodyFontFamily:'"Montserrat", sans-serif',bodyFontSize:16,bodyFontColor:"#393939",yAlign:"bottom",callbacks:{label:function(t,a){let o=null;return 0==t.index?o=e[0]:1==t.index?o=e[1]:2==t.index?o=e[2]:3==t.index?o=e[3]:4==t.index?o=e[4]:5==t.index?o=e[5]:6==t.index?o=e[6]:7==t.index?o=e[7]:8==t.index?o=e[8]:9==t.index&&(o=e[9]),"$"+o}}},t.update()};Chart.elements.Line.prototype.draw=function(){this._chart.ctx.save(),this._chart.ctx.strokeStyle="#B7D3F7";var t=this._chart.getDatasetMeta(0).data,e=t[parseInt($("input#comfort-days").val())-1]._model.x,a=t[parseInt($("input#comfort-days").val())-1]._model.y,o=this._chart.scales["y-axis-0"].bottom;this._chart.ctx.beginPath(),this._chart.ctx.lineWidth=5,$(window).width()<420?1==parseInt($("input#comfort-days").val())?(this._chart.ctx.moveTo(e+1.5,a),this._chart.ctx.lineTo(e+1.5,o)):10==parseInt($("input#comfort-days").val())||9==parseInt($("input#comfort-days").val())?(this._chart.ctx.moveTo(e-1.5,a),this._chart.ctx.lineTo(e-1.5,o)):(this._chart.ctx.moveTo(e,a),this._chart.ctx.lineTo(e,o)):1==parseInt($("input#comfort-days").val())?(this._chart.ctx.moveTo(e+1.5,a),this._chart.ctx.lineTo(e+1.5,o)):10==parseInt($("input#comfort-days").val())?(this._chart.ctx.moveTo(e-1.5,a),this._chart.ctx.lineTo(e-1.5,o)):(this._chart.ctx.moveTo(e,a),this._chart.ctx.lineTo(e,o));let n=parseInt($("input#comfort-days").val())+" "+declOfNum(parseInt($("input#comfort-days").val()),[den,dni,dniv]);$(window).width()<420?(this._chart.ctx.font='500 12px "Montserrat", sans-serif',this._chart.ctx.fillStyle="#393939",this._chart.ctx.textBaseline="bottom",10==parseInt($("input#comfort-days").val())||9==parseInt($("input#comfort-days").val())?(this._chart.ctx.textAlign="right",this._chart.ctx.fillText(n,e-5,o)):(this._chart.ctx.textAlign="left",this._chart.ctx.fillText(n,e+5,o))):(this._chart.ctx.font='500 16px "Montserrat", sans-serif',this._chart.ctx.fillStyle="#393939",this._chart.ctx.textBaseline="bottom",10==parseInt($("input#comfort-days").val())?(this._chart.ctx.textAlign="right",this._chart.ctx.fillText(n,e-5,o)):(this._chart.ctx.textAlign="left",this._chart.ctx.fillText(n,e+5,o))),this._chart.ctx.stroke(),this._chart.ctx.restore()};const calculatuion=(t,e)=>{let a=parseInt(t),o=parseInt(e),n=getPower(a),r=getM(n),i=getPriceReserve(n,r),s=getPrice(i,a,o),c=1.2,l=[],h=[];pushToTemplate(s,n.toFixed(0));for(let t=1;t<=10;t++)s=getPrice(i,a,t),l.push(s.toFixed(0)*c),h.push(parseInt(s.toFixed(0))),c++;updateChart(chart,h)};$("input#comfort-houseEnergy, input#comfort-days").ionRangeSlider({skin:"round",onChange:function(t){$(window).width()<1024&&$("body").css("overflow-y","hidden");let e=parseInt($("input#comfort-houseEnergy").val()),a=parseInt($("input#comfort-days").val());calculatuion(e,a)},onFinish:function(t){$(window).width()<1024&&$("body").css("overflow-y","scroll")}}),$(window).on("load",function(){$("body").animate({opacity:1}),$(window).width()<=1024?$(".work__content-info__item").filter(function(){return"1"==$(this).data("id")}).removeClass("active"):$(".work__content-info__item").filter(function(){return"1"==$(this).data("id")}).addClass("active"),USD=getActualCourse("USD"),EUR=getActualCourse("EUR"),M=getArrayM(),L=getL(),coefNight=getCoefNight(),coefAKB=getCoefAKB(),coefSun=getCoefSun();let t=parseInt($("input#comfort-houseEnergy").val()),e=parseInt($("input#comfort-days").val());defer(function(){createChart(canvas,t,e),calculatuion(t,e)},1e3)});